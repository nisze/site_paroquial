<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>B√≠blia Online - Par√≥quia Nossa Senhora Aparecida</title>
    <link rel="stylesheet" href="styles.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <script src="biblia-api.js"></script>
</head>
<body>
    <!-- NAVBAR -->
    <nav class="navbar">
        <div class="nav-container">
            <div class="logo">
                <i class="fas fa-church"></i>
                <span>Par√≥quia N. Sra. Aparecida</span>
            </div>
            <ul class="nav-menu" id="nav-menu">
                <li><a href="index.html" class="nav-link">In√≠cio</a></li>
                <li><a href="index.html#horarios" class="nav-link">Hor√°rios</a></li>
                <li><a href="biblia.html" class="nav-link active">B√≠blia</a></li>
                <li><a href="index.html#noticias" class="nav-link">Not√≠cias</a></li>
                <li><a href="index.html#grupos" class="nav-link">Grupos</a></li>
                <li><a href="index.html#galeria" class="nav-link">Galeria</a></li>
                <li><a href="index.html#contato" class="nav-link">Contato</a></li>
            </ul>
            <button class="nav-cta" onclick="window.location.href='index.html#servicos'">Solicitar Missa</button>
            <div class="hamburger" id="hamburger">
                <span></span>
                <span></span>
                <span></span>
            </div>
        </div>
    </nav>

    <!-- HEADER DA B√çBLIA -->
    <section class="biblia-hero">
        <div class="container">
            <div class="biblia-hero-content">
                <h1><i class="fas fa-book-open"></i> B√≠blia Online</h1>
                <p>Acesse a Palavra de Deus completa - Edi√ß√£o Pastoral</p>
                <div class="breadcrumb">
                    <a href="index.html"><i class="fas fa-home"></i> In√≠cio</a>
                    <span><i class="fas fa-chevron-right"></i></span>
                    <span>B√≠blia Online</span>
                </div>
            </div>
        </div>
    </section>

    <!-- SE√á√ÉO B√çBLIA ONLINE COMPLETA -->
    <section class="biblia-section">
        <div class="container">
            <div class="biblia-interface">
                <div class="biblia-controls">
                    <div class="testamento-selector">
                        <button class="testamento-btn active" data-testamento="at">Antigo Testamento</button>
                        <button class="testamento-btn" data-testamento="nt">Novo Testamento</button>
                    </div>
                    
                    <!-- BUSCA POR PALAVRA/FRASE -->
                    <div class="busca-textual-simples">
                        <div class="busca-compacta">
                            <input type="text" id="busca-palavra" placeholder="Buscar na B√≠blia..." class="busca-input-simples">
                            <button class="busca-btn-simples" id="buscar-palavra-btn">
                                <i class="fas fa-search"></i>
                            </button>
                        </div>
                        <div class="busca-opcoes-simples">
                            <label><input type="checkbox" id="busca-exata"> Exata</label>
                            <label><input type="checkbox" id="apenas-testamento"> S√≥ testamento atual</label>
                        </div>
                    </div>
                    
                    <div class="navegacao-divisor-simples">
                        <span>ou</span>
                    </div>
                    
                    <div class="biblia-selectors">
                        <div class="selector-group">
                            <label>Livro:</label>
                            <select class="biblia-select" id="livro-select">
                                <option value="">Selecione um livro</option>
                            </select>
                        </div>
                        
                        <div class="selector-group">
                            <label>Cap√≠tulo:</label>
                            <select class="biblia-select" id="capitulo-select">
                                <option value="">Cap.</option>
                            </select>
                        </div>
                        
                        <div class="selector-group">
                            <label>Vers√≠culo:</label>
                            <select class="biblia-select" id="versiculo-select">
                                <option value="">Vers.</option>
                            </select>
                        </div>
                        
                        <button class="biblia-buscar-btn">
                            <i class="fas fa-search"></i> Buscar
                        </button>
                    </div>
                </div>
                
                <div class="biblia-content">
                    <!-- RESULTADOS DA BUSCA -->
                    <div class="resultados-busca" id="resultados-busca" style="display: none;">
                        <div class="resultados-header">
                            <h3><i class="fas fa-search"></i> Resultados da Busca</h3>
                            <button class="fechar-busca" id="fechar-busca">
                                <i class="fas fa-times"></i> Voltar √† navega√ß√£o
                            </button>
                        </div>
                        <div class="resultados-lista" id="resultados-lista">
                            <!-- Resultados ser√£o inseridos aqui via JavaScript -->
                        </div>
                    </div>

                    <div class="biblia-texto" id="biblia-texto-principal">
                        <div class="capitulo-header">
                            <h3>G√™nesis - Cap√≠tulo 1</h3>
                            <p class="subtitulo">A Cria√ß√£o do Mundo</p>
                        </div>
                        
                        <div class="versiculos">
                            <div class="versiculo">
                                <span class="numero">1</span>
                                <span class="texto">No princ√≠pio, Deus criou o c√©u e a terra.</span>
                            </div>
                            <div class="versiculo">
                                <span class="numero">2</span>
                                <span class="texto">A terra estava vazia e vaga, as trevas cobriam o abismo, e o Esp√≠rito de Deus pairava sobre as √°guas.</span>
                            </div>
                            <div class="versiculo">
                                <span class="numero">3</span>
                                <span class="texto">Deus disse: "Fa√ßa-se a luz!" E a luz foi feita.</span>
                            </div>
                            <div class="versiculo">
                                <span class="numero">4</span>
                                <span class="texto">Deus viu que a luz era boa, e separou a luz das trevas.</span>
                            </div>
                            <div class="versiculo">
                                <span class="numero">5</span>
                                <span class="texto">Deus chamou dia √† luz, e noite √†s trevas. Houve uma tarde e uma manh√£: foi o primeiro dia.</span>
                            </div>
                        </div>
                        
                        <div class="biblia-navegacao">
                            <button class="nav-btn" id="capitulo-anterior">
                                <i class="fas fa-chevron-left"></i> Cap√≠tulo Anterior
                            </button>
                            <span class="nav-info" id="nav-info-atual">G√™nesis 1</span>
                            <button class="nav-btn" id="proximo-capitulo">
                                Pr√≥ximo Cap√≠tulo <i class="fas fa-chevron-right"></i>
                            </button>
                        </div>

                        <!-- ATALHOS R√ÅPIDOS -->
                        <div class="atalhos-biblicos">
                            <h4><i class="fas fa-star"></i> Passagens Populares</h4>
                            <div class="atalhos-grid">
                                <button class="atalho-btn" data-livro="genesis" data-capitulo="1">
                                    <strong>Gn 1</strong><span>A Cria√ß√£o</span>
                                </button>
                                <button class="atalho-btn" data-livro="salmos" data-capitulo="23">
                                    <strong>Sl 23</strong><span>O Bom Pastor</span>
                                </button>
                                <button class="atalho-btn" data-livro="salmos" data-capitulo="91">
                                    <strong>Sl 91</strong><span>Prote√ß√£o Divina</span>
                                </button>
                                <button class="atalho-btn" data-livro="mateus" data-capitulo="5">
                                    <strong>Mt 5</strong><span>Bem-aventuran√ßas</span>
                                </button>
                                <button class="atalho-btn" data-livro="joao" data-capitulo="1">
                                    <strong>Jo 1</strong><span>O Verbo</span>
                                </button>
                                <button class="atalho-btn" data-livro="joao" data-capitulo="14">
                                    <strong>Jo 14</strong><span>Caminho, Verdade</span>
                                </button>
                                <button class="atalho-btn" data-livro="apocalipse" data-capitulo="21">
                                    <strong>Ap 21</strong><span>Nova Jerusal√©m</span>
                                </button>
                                <button class="atalho-btn" data-livro="proverbios" data-capitulo="31">
                                    <strong>Pv 31</strong><span>Mulher Virtuosa</span>
                                </button>
                            </div>
                        </div>
                    </div>
                    
                    <div class="biblia-sidebar">
                        <div class="reflexao-diaria">
                            <h4><i class="fas fa-heart"></i> Reflex√£o do Dia</h4>
                            <p>"No princ√≠pio era o Verbo..." (Jo√£o 1,1)</p>
                            <p class="reflexao-texto">Deus se revela atrav√©s de sua Palavra. Que possamos sempre buscar seu amor e sabedoria nas Escrituras.</p>
                        </div>
                        
                        <div class="santos-do-dia">
                            <h4><i class="fas fa-pray"></i> Santos do Dia</h4>
                            <p><strong>S√£o Jo√£o XXIII</strong></p>
                            <p class="santo-descricao">Papa que convocou o Conc√≠lio Vaticano II</p>
                        </div>
                        
                        <div class="compartilhar">
                            <h4><i class="fas fa-share"></i> Compartilhar</h4>
                            <div class="share-buttons">
                                <button class="share-btn facebook"><i class="fab fa-facebook"></i></button>
                                <button class="share-btn whatsapp"><i class="fab fa-whatsapp"></i></button>
                                <button class="share-btn twitter"><i class="fab fa-twitter"></i></button>
                                <button class="share-btn copy"><i class="fas fa-copy"></i></button>
                            </div>
                        </div>

                        <!-- VERS√çCULO DO DIA -->
                        <div class="versiculo-do-dia">
                            <h4><i class="fas fa-quote-left"></i> Vers√≠culo do Dia</h4>
                            <blockquote>
                                "Porque Deus amou o mundo de tal maneira que deu o seu Filho unig√™nito, para que todo aquele que nele cr√™ n√£o pere√ßa, mas tenha a vida eterna."
                                <cite>Jo√£o 3:16</cite>
                            </blockquote>
                        </div>

                        <!-- ESTAT√çSTICAS -->
                        <div class="biblia-stats">
                            <h4><i class="fas fa-chart-bar"></i> Sobre a B√≠blia</h4>
                            <div class="stats-list">
                                <div class="stat-item">
                                    <span class="stat-number">73</span>
                                    <span class="stat-label">Livros</span>
                                </div>
                                <div class="stat-item">
                                    <span class="stat-number">1189</span>
                                    <span class="stat-label">Cap√≠tulos</span>
                                </div>
                                <div class="stat-item">
                                    <span class="stat-number">31000+</span>
                                    <span class="stat-label">Vers√≠culos</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- FOOTER -->
    <footer class="footer">
        <div class="container">
            <div class="footer-content">
                <div class="footer-section">
                    <h3>Par√≥quia Nossa Senhora Aparecida</h3>
                    <p>Uma comunidade de f√© que acolhe e evangeliza</p>
                    <div class="social-links">
                        <a href="#"><i class="fab fa-facebook"></i></a>
                        <a href="#"><i class="fab fa-instagram"></i></a>
                        <a href="#"><i class="fab fa-youtube"></i></a>
                        <a href="#"><i class="fab fa-whatsapp"></i></a>
                    </div>
                </div>

                <div class="footer-section">
                    <h4>Links R√°pidos</h4>
                    <ul>
                        <li><a href="index.html#horarios">Hor√°rios de Missa</a></li>
                        <li><a href="biblia.html">B√≠blia Online</a></li>
                        <li><a href="index.html#noticias">Not√≠cias</a></li>
                        <li><a href="index.html#grupos">Grupos e Pastorais</a></li>
                        <li><a href="index.html#contato">Contato</a></li>
                    </ul>
                </div>

                <div class="footer-section">
                    <h4>Contato</h4>
                    <div class="contact-info">
                        <p><i class="fas fa-map-marker-alt"></i> Av. Nisshimbo do Brasil, 1236<br>Vila Camar√£o - Itapetininga/SP</p>
                        <p><i class="fas fa-phone"></i> (15) 3272-8718</p>
                        <p><i class="fas fa-envelope"></i> p.n.s.aparecida@hotmail.com</p>
                    </div>
                </div>

                <div class="footer-section">
                    <h4>Hor√°rio de Atendimento</h4>
                    <p>Segunda a Sexta: 8h √†s 12h30<br>13h30 √†s 17h</p>
                    <p>S√°bado: 8h √†s 12h</p>
                </div>
            </div>
            
            <div class="footer-bottom">
                <p>&copy; 2025 Par√≥quia Nossa Senhora Aparecida. Todos os direitos reservados.</p>
            </div>
        </div>
    </footer>

    <script src="script.js"></script>
    <script>
        // ===== IMPLEMENTA√á√ÉO DA BUSCA POR TEXTO =====
        
        // Elementos DOM
        let buscaPalavraInput;
        let buscarPalavraBotao;
        let buscaExataCheckbox;
        let apenasTestamentoCheckbox;
        let resultadosBusca;
        let resultadosLista;
        let fecharBuscaBotao;
        let bibliaTextoPrincipal;
        let testamentoAtual = 'at'; // 'at' ou 'nt'
        
        // Navega√ß√£o entre cap√≠tulos
        let capituloAnteriorBtn;
        let proximoCapituloBtn;
        let navInfoAtual;
        let livroAtual = 'genesis';
        let capituloAtualNum = 1;

        // Estrutura da B√≠blia para navega√ß√£o
        const estruturaBiblia = {
            'genesis': { nome: 'G√™nesis', capitulos: 50, testamento: 'at' },
            'exodus': { nome: '√äxodo', capitulos: 40, testamento: 'at' },
            'leviticus': { nome: 'Lev√≠tico', capitulos: 27, testamento: 'at' },
            'numbers': { nome: 'N√∫meros', capitulos: 36, testamento: 'at' },
            'deuteronomy': { nome: 'Deuteron√¥mio', capitulos: 34, testamento: 'at' },
            'psalms': { nome: 'Salmos', capitulos: 150, testamento: 'at' },
            'proverbs': { nome: 'Prov√©rbios', capitulos: 31, testamento: 'at' },
            'isaiah': { nome: 'Isa√≠as', capitulos: 66, testamento: 'at' },
            'jeremiah': { nome: 'Jeremias', capitulos: 52, testamento: 'at' },
            'ezekiel': { nome: 'Ezequiel', capitulos: 48, testamento: 'at' },
            'matthew': { nome: 'Mateus', capitulos: 28, testamento: 'nt' },
            'mark': { nome: 'Marcos', capitulos: 16, testamento: 'nt' },
            'luke': { nome: 'Lucas', capitulos: 24, testamento: 'nt' },
            'john': { nome: 'Jo√£o', capitulos: 21, testamento: 'nt' },
            'acts': { nome: 'Atos', capitulos: 28, testamento: 'nt' },
            'romans': { nome: 'Romanos', capitulos: 16, testamento: 'nt' },
            '1corinthians': { nome: '1 Cor√≠ntios', capitulos: 16, testamento: 'nt' },
            '2corinthians': { nome: '2 Cor√≠ntios', capitulos: 13, testamento: 'nt' },
            'ephesians': { nome: 'Ef√©sios', capitulos: 6, testamento: 'nt' },
            'philippians': { nome: 'Filipenses', capitulos: 4, testamento: 'nt' },
            '1john': { nome: '1 Jo√£o', capitulos: 5, testamento: 'nt' },
            'hebrews': { nome: 'Hebreus', capitulos: 13, testamento: 'nt' },
            'revelation': { nome: 'Apocalipse', capitulos: 22, testamento: 'nt' }
        };

        // Ordem dos livros para navega√ß√£o sequencial
        const ordemLivros = [
            'genesis', 'exodus', 'leviticus', 'numbers', 'deuteronomy',
            'psalms', 'proverbs', 'isaiah', 'jeremiah', 'ezekiel',
            'matthew', 'mark', 'luke', 'john', 'acts', 'romans',
            '1corinthians', '2corinthians', 'ephesians', 'philippians',
            '1john', 'hebreus', 'revelation'
        ];

        // Inicializar quando DOM estiver carregado
        document.addEventListener('DOMContentLoaded', function() {
            console.log('üîç Inicializando sistema de busca b√≠blica...');
            
            // Selecionar elementos DOM para busca
            buscaPalavraInput = document.getElementById('busca-palavra');
            buscarPalavraBotao = document.getElementById('buscar-palavra-btn');
            buscaExataCheckbox = document.getElementById('busca-exata');
            apenasTestamentoCheckbox = document.getElementById('apenas-testamento');
            resultadosBusca = document.getElementById('resultados-busca');
            resultadosLista = document.getElementById('resultados-lista');
            fecharBuscaBotao = document.getElementById('fechar-busca');
            bibliaTextoPrincipal = document.getElementById('biblia-texto-principal');

            // Selecionar elementos DOM para navega√ß√£o
            capituloAnteriorBtn = document.getElementById('capitulo-anterior');
            proximoCapituloBtn = document.getElementById('proximo-capitulo');
            navInfoAtual = document.getElementById('nav-info-atual');

            // Verificar se todos os elementos foram encontrados
            if (!buscaPalavraInput || !buscarPalavraBotao) {
                console.error('‚ùå Elementos de busca n√£o encontrados!');
                return;
            }

            if (!capituloAnteriorBtn || !proximoCapituloBtn) {
                console.error('‚ùå Elementos de navega√ß√£o n√£o encontrados!');
                return;
            }

            // Adicionar event listeners
            configurarEventListeners();
            
            // Configurar testamentos
            configurarTestamentos();
            
            // Configurar navega√ß√£o
            configurarNavegacao();
            
            console.log('‚úÖ Sistema de busca e navega√ß√£o inicializados com sucesso!');
        });

        function configurarEventListeners() {
            // Bot√£o de busca
            buscarPalavraBotao.addEventListener('click', executarBusca);
            
            // Enter no campo de busca
            buscaPalavraInput.addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    executarBusca();
                }
            });
            
            // Fechar resultados
            if (fecharBuscaBotao) {
                fecharBuscaBotao.addEventListener('click', fecharResultados);
            }
        }

        function configurarNavegacao() {
            // Bot√£o cap√≠tulo anterior
            capituloAnteriorBtn.addEventListener('click', irCapituloAnterior);
            
            // Bot√£o pr√≥ximo cap√≠tulo
            proximoCapituloBtn.addEventListener('click', irProximoCapitulo);
            
            // Atualizar estado inicial dos bot√µes
            atualizarEstadoBotoes();
        }

        function irCapituloAnterior() {
            console.log('üìñ Navegando para cap√≠tulo anterior...');
            
            // Se n√£o √© o primeiro cap√≠tulo do livro atual
            if (capituloAtualNum > 1) {
                capituloAtualNum--;
            } else {
                // Ir para o √∫ltimo cap√≠tulo do livro anterior
                const indiceAtual = ordemLivros.indexOf(livroAtual);
                if (indiceAtual > 0) {
                    livroAtual = ordemLivros[indiceAtual - 1];
                    capituloAtualNum = estruturaBiblia[livroAtual].capitulos;
                } else {
                    // J√° √© o primeiro cap√≠tulo da B√≠blia
                    alert('Este √© o primeiro cap√≠tulo da B√≠blia!');
                    return;
                }
            }
            
            carregarCapituloAtual();
        }

        function irProximoCapitulo() {
            console.log('üìñ Navegando para pr√≥ximo cap√≠tulo...');
            
            // Se n√£o √© o √∫ltimo cap√≠tulo do livro atual
            if (capituloAtualNum < estruturaBiblia[livroAtual].capitulos) {
                capituloAtualNum++;
            } else {
                // Ir para o primeiro cap√≠tulo do pr√≥ximo livro
                const indiceAtual = ordemLivros.indexOf(livroAtual);
                if (indiceAtual < ordemLivros.length - 1) {
                    livroAtual = ordemLivros[indiceAtual + 1];
                    capituloAtualNum = 1;
                } else {
                    // J√° √© o √∫ltimo cap√≠tulo da B√≠blia
                    alert('Este √© o √∫ltimo cap√≠tulo da B√≠blia!');
                    return;
                }
            }
            
            carregarCapituloAtual();
        }

        async function carregarCapituloAtual() {
            try {
                console.log(`üìñ Carregando ${livroAtual} ${capituloAtualNum}`);
                
                // Mostrar loading nos bot√µes
                capituloAnteriorBtn.disabled = true;
                proximoCapituloBtn.disabled = true;
                capituloAnteriorBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Carregando...';
                proximoCapituloBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Carregando...';
                
                // Usar a API para carregar o cap√≠tulo
                const dadosCapitulo = await window.bibliaAPI.buscarCapitulo(livroAtual, capituloAtualNum);
                
                if (dadosCapitulo) {
                    // Fechar resultados da busca se estiverem abertos
                    fecharResultados();
                    
                    // Exibir o cap√≠tulo
                    exibirCapitulo(dadosCapitulo);
                    
                    // Atualizar info de navega√ß√£o
                    atualizarInfoNavegacao();
                } else {
                    alert('Cap√≠tulo n√£o encontrado. Tente novamente.');
                }
                
            } catch (error) {
                console.error('Erro ao carregar cap√≠tulo:', error);
                alert('Erro ao carregar cap√≠tulo. Tente novamente.');
            } finally {
                // Restaurar bot√µes
                atualizarEstadoBotoes();
            }
        }

        function atualizarInfoNavegacao() {
            const nomelivro = estruturaBiblia[livroAtual].nome;
            navInfoAtual.textContent = `${nomelivro} ${capituloAtualNum}`;
        }

        function atualizarEstadoBotoes() {
            // Bot√£o anterior
            const isPrimeiroCapitulo = (livroAtual === ordemLivros[0] && capituloAtualNum === 1);
            capituloAnteriorBtn.disabled = isPrimeiroCapitulo;
            capituloAnteriorBtn.innerHTML = '<i class="fas fa-chevron-left"></i> Cap√≠tulo Anterior';
            
            // Bot√£o pr√≥ximo
            const isUltimoCapitulo = (
                livroAtual === ordemLivros[ordemLivros.length - 1] && 
                capituloAtualNum === estruturaBiblia[livroAtual].capitulos
            );
            proximoCapituloBtn.disabled = isUltimoCapitulo;
            proximoCapituloBtn.innerHTML = 'Pr√≥ximo Cap√≠tulo <i class="fas fa-chevron-right"></i>';
            
            // Atualizar apar√™ncia visual dos bot√µes desabilitados
            if (isPrimeiroCapitulo) {
                capituloAnteriorBtn.style.opacity = '0.5';
                capituloAnteriorBtn.style.cursor = 'not-allowed';
            } else {
                capituloAnteriorBtn.style.opacity = '1';
                capituloAnteriorBtn.style.cursor = 'pointer';
            }
            
            if (isUltimoCapitulo) {
                proximoCapituloBtn.style.opacity = '0.5';
                proximoCapituloBtn.style.cursor = 'not-allowed';
            } else {
                proximoCapituloBtn.style.opacity = '1';
                proximoCapituloBtn.style.cursor = 'pointer';
            }
        }

        function configurarTestamentos() {
            // Bot√µes de testamento
            const testamentoBtns = document.querySelectorAll('.testamento-btn');
            testamentoBtns.forEach(btn => {
                btn.addEventListener('click', function() {
                    // Remover active de todos
                    testamentoBtns.forEach(b => b.classList.remove('active'));
                    // Adicionar active ao clicado
                    this.classList.add('active');
                    // Atualizar testamento atual
                    testamentoAtual = this.dataset.testamento;
                    console.log(`üìñ Testamento alterado para: ${testamentoAtual}`);
                });
            });
        }

        async function executarBusca() {
            const palavraChave = buscaPalavraInput.value.trim();
            
            if (!palavraChave || palavraChave.length < 2) {
                alert('Por favor, digite pelo menos 2 caracteres para buscar.');
                return;
            }

            console.log(`üîç Executando busca por: "${palavraChave}"`);
            
            // Mostrar loading
            mostrarLoading();
            
            try {
                // Preparar op√ß√µes de busca
                const opcoes = {
                    buscaExata: buscaExataCheckbox ? buscaExataCheckbox.checked : false,
                    testamentoAtual: apenasTestamentoCheckbox && apenasTestamentoCheckbox.checked ? testamentoAtual : null,
                    versao: 'almeida',
                    limite: 50
                };
                
                console.log('Op√ß√µes de busca:', opcoes);
                
                // Executar busca usando a API
                const resultados = await window.bibliaAPI.buscarTexto(palavraChave, opcoes);
                
                console.log(`üìä Resultados encontrados:`, resultados);
                
                // Exibir resultados
                exibirResultados(palavraChave, resultados);
                
            } catch (error) {
                console.error('‚ùå Erro na busca:', error);
                alert('Erro ao realizar a busca. Tente novamente.');
                esconderLoading();
            }
        }

        function mostrarLoading() {
            if (buscarPalavraBotao) {
                buscarPalavraBotao.innerHTML = '<i class="fas fa-spinner fa-spin"></i>';
                buscarPalavraBotao.disabled = true;
            }
        }

        function esconderLoading() {
            if (buscarPalavraBotao) {
                buscarPalavraBotao.innerHTML = '<i class="fas fa-search"></i>';
                buscarPalavraBotao.disabled = false;
            }
        }

        function exibirResultados(palavraChave, resultados) {
            esconderLoading();
            
            if (!resultados || resultados.length === 0) {
                exibirSemResultados(palavraChave);
                return;
            }

            // Esconder texto principal e mostrar resultados
            if (bibliaTextoPrincipal) bibliaTextoPrincipal.style.display = 'none';
            if (resultadosBusca) resultadosBusca.style.display = 'block';
            
            // Gerar HTML dos resultados
            const resultadosHTML = gerarHTMLResultados(palavraChave, resultados);
            
            if (resultadosLista) {
                resultadosLista.innerHTML = resultadosHTML;
            }
            
            console.log(`‚úÖ ${resultados.length} resultados exibidos`);
        }

        function gerarHTMLResultados(palavraChave, resultados) {
            const totalResultados = resultados.length;
            
            let html = `
                <div class="resultados-info">
                    <p><i class="fas fa-search"></i> <strong>${totalResultados}</strong> resultado${totalResultados !== 1 ? 's' : ''} para "<em>${palavraChave}</em>"</p>
                </div>
            `;
            
            resultados.forEach(resultado => {
                // Destacar palavra-chave no texto
                const textoDestacado = destacarPalavraChave(resultado.texto, palavraChave);
                
                html += `
                    <div class="resultado-item">
                        <div class="resultado-referencia">
                            <strong>${resultado.referencia}</strong>
                            <span class="resultado-fonte">${resultado.fonte === 'API' ? 'üåê' : 'üì±'}</span>
                        </div>
                        <div class="resultado-texto">
                            ${textoDestacado}
                        </div>
                        <div class="resultado-acoes">
                            <button onclick="carregarCapitulo('${resultado.livro}', ${resultado.capitulo})" class="btn-ver-capitulo">
                                <i class="fas fa-book-open"></i> Ver cap√≠tulo completo
                            </button>
                        </div>
                    </div>
                `;
            });
            
            return html;
        }

        function destacarPalavraChave(texto, palavraChave) {
            const regex = new RegExp(`(${palavraChave})`, 'gi');
            return texto.replace(regex, '<mark class="highlight-search">$1</mark>');
        }

        function exibirSemResultados(palavraChave) {
            esconderLoading();
            
            // Esconder texto principal e mostrar resultados
            if (bibliaTextoPrincipal) bibliaTextoPrincipal.style.display = 'none';
            if (resultadosBusca) resultadosBusca.style.display = 'block';
            
            if (resultadosLista) {
                resultadosLista.innerHTML = `
                    <div class="sem-resultados">
                        <i class="fas fa-search"></i>
                        <h3>Nenhum resultado encontrado</h3>
                        <p>N√£o foram encontrados vers√≠culos contendo "<strong>${palavraChave}</strong>".</p>
                        <div class="dicas-busca">
                            <h4>Dicas para melhorar sua busca:</h4>
                            <ul>
                                <li>Verifique a ortografia das palavras</li>
                                <li>Use palavras-chave mais espec√≠ficas</li>
                                <li>Tente sin√¥nimos ou termos relacionados</li>
                                <li>Desmarque "Busca exata" para resultados mais amplos</li>
                            </ul>
                        </div>
                        <div class="sugestoes-busca">
                            <h4>Sugest√µes de busca:</h4>
                            <div class="sugestoes-botoes">
                                <button onclick="buscarSugestao('amor')" class="btn-sugestao">amor</button>
                                <button onclick="buscarSugestao('paz')" class="btn-sugestao">paz</button>
                                <button onclick="buscarSugestao('f√©')" class="btn-sugestao">f√©</button>
                                <button onclick="buscarSugestao('esperan√ßa')" class="btn-sugestao">esperan√ßa</button>
                                <button onclick="buscarSugestao('Jesus')" class="btn-sugestao">Jesus</button>
                                <button onclick="buscarSugestao('Deus')" class="btn-sugestao">Deus</button>
                            </div>
                        </div>
                    </div>
                `;
            }
        }

        function buscarSugestao(termo) {
            if (buscaPalavraInput) {
                buscaPalavraInput.value = termo;
                executarBusca();
            }
        }

        function fecharResultados() {
            // Mostrar texto principal e esconder resultados
            if (bibliaTextoPrincipal) bibliaTextoPrincipal.style.display = 'block';
            if (resultadosBusca) resultadosBusca.style.display = 'none';
            
            // Limpar campo de busca
            if (buscaPalavraInput) buscaPalavraInput.value = '';
        }

        async function carregarCapitulo(livro, capitulo) {
            console.log(`üìñ Carregando cap√≠tulo ${livro} ${capitulo}`);
            
            try {
                // Atualizar vari√°veis de navega√ß√£o
                livroAtual = livro.toLowerCase();
                capituloAtualNum = parseInt(capitulo);
                
                // Usar a API para carregar o cap√≠tulo
                const dadosCapitulo = await window.bibliaAPI.buscarCapitulo(livroAtual, capituloAtualNum);
                
                if (dadosCapitulo) {
                    // Fechar resultados da busca
                    fecharResultados();
                    
                    // Exibir o cap√≠tulo na √°rea principal
                    exibirCapitulo(dadosCapitulo);
                    
                    // Atualizar navega√ß√£o
                    atualizarInfoNavegacao();
                    atualizarEstadoBotoes();
                } else {
                    alert('Cap√≠tulo n√£o encontrado. Tente novamente.');
                }
                
            } catch (error) {
                console.error('Erro ao carregar cap√≠tulo:', error);
                alert('Erro ao carregar cap√≠tulo. Tente novamente.');
            }
        }

        function exibirCapitulo(dadosCapitulo) {
            if (!bibliaTextoPrincipal) return;
            
            let html = `
                <div class="capitulo-header">
                    <h3>${dadosCapitulo.referencia}</h3>
                    <p class="subtitulo">Clique em um vers√≠culo para destac√°-lo</p>
                </div>
                
                <div class="versiculos">
            `;
            
            dadosCapitulo.versiculos.forEach(versiculo => {
                html += `
                    <div class="versiculo" onclick="destacarVersiculo(this)">
                        <span class="numero">${versiculo.numero}</span>
                        <span class="texto">${versiculo.texto}</span>
                    </div>
                `;
            });
            
            html += '</div>';
            
            bibliaTextoPrincipal.innerHTML = html;
        }

        function destacarVersiculo(elemento) {
            // Remover destaque de outros vers√≠culos
            const versiculos = document.querySelectorAll('.versiculo');
            versiculos.forEach(v => v.classList.remove('destacado'));
            
            // Adicionar destaque ao vers√≠culo clicado
            elemento.classList.add('destacado');
        }

        // Fun√ß√£o global para teste
        window.testarBusca = async function(termo) {
            if (buscaPalavraInput) {
                buscaPalavraInput.value = termo;
                await executarBusca();
            }
        };

        console.log('üîç Script de busca b√≠blica carregado!');
        console.log('üí° Para testar: window.testarBusca("amor")');
    </script>
</body>
</html>